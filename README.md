![image](https://github.com/user-attachments/assets/e3192397-50e1-4c3e-9730-75af39540ac5)# Домашнее задание №4 по конфигурационному управлению
## Номер варианта: 24
## **Формулировка задачи**

Разработать ассемблер и интерпретатор для учебной виртуальной машины
(УВМ). Система команд УВМ представлена далее.
Для ассемблера необходимо разработать читаемое представление команд
УВМ. Ассемблер принимает на вход файл с текстом исходной программы, путь к
которой задается из командной строки. Результатом работы ассемблера является
бинарный файл в виде последовательности байт, путь к которому задается из
командной строки. Дополнительный ключ командной строки задает путь к файлулогу, в котором хранятся ассемблированные инструкции в духе списков
“ключ=значение”, как в приведенных далее тестах.

Интерпретатор принимает на вход бинарный файл, выполняет команды УВМ
и сохраняет в файле-результате значения из диапазона памяти УВМ. Диапазон
также указывается из командной строки.
Форматом для файла-лога и файла-результата является yaml.
Необходимо реализовать приведенные тесты для всех команд, а также
написать и отладить тестовую программу.

---

### Загрузка константы  
| A | B           |  
|---|-------------|  
| Биты 0—3 | Биты 4—26 |  
| 13 | Константа |  

Размер команды: 4 байт. Операнд: поле B. Результат: регистр-аккумулятор.  
**Тест (A=13, B=594):**  
`0x2D, 0x25, 0x00, 0x00`  

![image](https://github.com/user-attachments/assets/9232f7c3-4cc6-4ae1-bcce-8e60aafca542)

![image](https://github.com/user-attachments/assets/cf15834f-5e52-43be-99ef-100a3ba4efc8)

---

### Чтение значения из памяти  
| A |
|---|
| Биты 0—3 | 
| 5 |

Размер команды: 1 байт. Операнд: значение в памяти по адресу, которым
является регистр-аккумулятор. Результат: регистр-аккумулятор.  
**Тест (A=5):**  
`0x05`  

![image](https://github.com/user-attachments/assets/75012c2f-08e6-4e06-ac36-f10749706505)

![image](https://github.com/user-attachments/assets/9badf4b4-dd04-401b-8fac-a028125d99de)


---

### Запись значения в память  
| A | B           |  
|---|-------------|  
| Биты 0—3 | Биты 4—33 |  
| 12 | Адрес |  

Размер команды: 5 байт. Операнд: регистр-аккумулятор. Результат: значение
в памяти по адресу, которым является поле B.
**Тест (A=12, B=101):**  
`0x5C, 0x06, 0x00, 0x00, 0x00`  

![image](https://github.com/user-attachments/assets/518128e6-57ab-488b-9925-ae23a0a69103)


![image](https://github.com/user-attachments/assets/55cb0baf-517d-4cd9-a3b0-ab265898529e)


---

### Бинарная операция: побитовый арифметический сдвиг вправо
| A | B           |  
|---|-------------|  
| Биты 0—3 | Биты 4—27 |  
| 1 | Адрес |  

Размер команды: 5 байт. Первый операнд: регистр-аккумулятор. Второй
операнд: значение в памяти по адресу, которым является поле B. Результат:
регистр-аккумулятор.

  
**Тест (A=1, B=138):**  
`0xA1, 0x08, 0x00, 0x00, 0x00`  

![image](https://github.com/user-attachments/assets/acf9d844-7c0e-4adf-a005-ad2e9eeee9d8)

![image](https://github.com/user-attachments/assets/c8a3d266-d3c8-4682-a672-335832f3e62f)

---

### Тестовая программа  
Выполнить поэлементно операцию побитовый арифметический сдвиг вправо над
двумя векторами длины 5. Результат записать во второй вектор. 

---  
### Описание функции
Описание функций в assembler.py
`assemble(input_file, output_file, log_file)`
Назначение: Компилирует ассемблерный код из текстового файла в бинарный формат и создаёт лог-файл в формате YAML.

Параметры:
input_file (str): Путь к входному файлу с ассемблерным кодом.
output_file (str): Путь к выходному бинарному файлу.
log_file (str): Путь к лог-файлу, который будет содержать описание команд и их преобразование в байты.

Описание работы:

Читает файл с ассемблерным кодом построчно.

Разбивает строки на команды и аргументы.

Для каждой команды генерирует машинный код:

Преобразует команды в соответствии с таблицей COMMANDS.

Упаковывает данные в нужный формат с помощью struct.

Создаёт бинарный файл, содержащий скомпилированные инструкции.

Создаёт YAML-лог с подробной информацией о преобразовании команд.


Описание функций в interpretator.py 
`execute(binary_file, result_file, memory_range)`

Назначение: Выполняет бинарный файл, интерпретируя его команды, и сохраняет содержимое памяти в указанных диапазонах в YAML-файл.

Параметры:
binary_file (str): Путь к входному бинарному файлу.
result_file (str): Путь к выходному YAML-файлу, в котором будут сохранены результаты выполнения (содержимое памяти).
memory_range (str): Диапазон памяти для сохранения в формате start:end.

Описание работы:

Инициализирует память (MEMORY_SIZE) и аккумулятор.

Читает бинарные данные из файла.

Пошагово интерпретирует команды:

Распознаёт команды по опкоду.

Выполняет операции над памятью или аккумулятором (например, LOAD_CONST, STORE_MEM, SHR).

Извлекает содержимое памяти в указанном диапазоне start:end.

Сохраняет извлечённые данные в файл в формате YAML.

---  

### Результат тестовая программа  
Выполнить поэлементно операцию побитовый арифметический сдвиг вправо наддвумя векторами длины 5. Результат записать во второй вектор.
Тестовый пример: 
```  
LOAD_CONST 4  
STORE_MEM 1
LOAD_CONST 16
STORE_MEM 2
LOAD_CONST 32
STORE_MEM 3
LOAD_CONST 64
STORE_MEM 4
LOAD_CONST 128
STORE_MEM 5
LOAD_CONST 3
STORE_MEM 6
LOAD_CONST 5
STORE_MEM 7
LOAD_CONST 9
STORE_MEM 8
LOAD_CONST 11
STORE_MEM 9
LOAD_CONST 13
STORE_MEM 10
LOAD_CONST 1
LOAD_MEM
SHR 1
STORE_MEM 6
LOAD_CONST 2
LOAD_MEM
SHR 1
STORE_MEM 7
LOAD_CONST 3
LOAD_MEM
SHR 1
STORE_MEM 8
LOAD_CONST 4
LOAD_MEM
SHR 1
STORE_MEM 9
LOAD_CONST 5
LOAD_MEM
SHR 1
STORE_MEM 10
```
Результат до сдвига: 

![image](https://github.com/user-attachments/assets/af14f372-72da-40aa-ad41-8cc974feaf94)

Результат после сдвига:

![image](https://github.com/user-attachments/assets/2149e28e-9ed9-4586-8e53-1a0e923bd582)


---  
